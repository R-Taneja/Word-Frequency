<!DOCTYPE html>
<html>
<head>
    <title>Word Frequency Counter by Rohan Taneja</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/tiny-markdown-editor@0.1.2/dist/tiny-mde.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/tiny-markdown-editor@0.1.2/dist/tiny-mde.min.css" />
    
    <script src="//cdn.quilljs.com/1.3.6/quill.js"></script>
    <script src="//cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
</head>
<body>
    <div class="center">
        <h1>Improve your writing</h1>
        <p>Reduce the number of repeated words in a paragraph with this free word frequency counter. Try typing one of the repeated words into the search box and clicking "Search" to see exactly where they are in your text.<br><br>Note: the word frequency counter and search box are case-sensitive.</p>
        <br>
        <div style="display: flex;">
            <input type="text" name="wordToHighlight" id="wordToHighlight" placeholder="Search for a word..." style="float: left;">
            <button onclick="highlightWord()" style="float: right;">Search</button>
        </div>
        <br>
        <div id="editor"></div>
        <br>
        <input type="submit" id="submitbutton" value="Submit" style="width: 100%;" onclick="decider()">
        <br>
        <h1 id="resultsHeader"></h1>
        <p style="white-space: pre-wrap" id="results"></p>
    </div>
    
    <script type="text/javascript">
        var inputText;
        
        var options = {
              modules: {
                toolbar: false
              },
              theme: 'snow'
        };
        var quill = new Quill('#editor', options);
    
        function decider() {
            quill.formatText(0, quill.getLength(), {
                'bold': false,
            });
            inputText = quill.getText();
            
            console.log(inputText);
            if (inputText != "\n") {
                document.getElementById("results").innerHTML = "";
                textCounter();
            } else {
                textCounter();
            }
        }
        
        function textCounter() {
            var pattern = /\w+/g,
                string = inputText;
                matchedWords = string.match( pattern );
            var counts = matchedWords.reduce(function ( stats, word ) {
                if ( stats.hasOwnProperty( word ) ) {
                    stats[ word ] = stats[ word ] + 1;
                } else {
                    stats[ word ] = 1;
                }
                return stats;
            }, {} );
            
            for (const word in counts) {
                var resultsText = document.getElementById("results");
                if (counts[word] == 1) {
                    resultsText.innerHTML += `${word}: ${counts[word]} time`;
                } else {
                    resultsText.innerHTML += `${word}: ${counts[word]} times`;
                }
                resultsText.textContent += `\n`;
            }
            
            var resultsHeader = document.getElementById("resultsHeader");
            resultsHeader.textContent = "Results";
            document.getElementById("submitbutton").value = "Check again";
        };
    </script>
</body>
</html>
