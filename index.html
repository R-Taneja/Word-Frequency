<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YYY5LP5LKG"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-YYY5LP5LKG');
    </script>
    <title>Word Frequency Counter</title>
    <link rel="stylesheet" href="style.css">
    <script src="//cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <meta name="description" content="A free word frequency counter built by Rohan Taneja.">
    <meta name="keywords" content="word, frequency, counter, word counter, word frequency counter, repeated words, repeated, repeat, redundancy, repeated word counter">
    <meta name="author" content="Rohan Taneja">
</head>
<body>
    <div class="center">
        <h1>Improve your writing</h1>
        <p>Reduce the number of repeated words in a text with this free word frequency counter. Try typing one of the repeated words into the search box and clicking "Search" to see exactly where it is in your text.</p>
        <br>
        <div style="display: flex;">
            <input type="text" name="wordToHighlight" id="wordToHighlight" placeholder="Search for a word..." style="float: left;">
            <button onclick="highlightWord()" style="float: right;">Search</button>
        </div>
        <br>
        <div id="editor"></div>
        <br>
        <input type="submit" id="submitbutton" value="Submit" style="width: 100%;" onclick="decider()">
        <br>
        <h1 id="resultsHeader"></h1>
        <table id="table">
        </table>
        <h1>
            Ads
        </h1>
        <p>Ads keep this service free. Try searching for your favorite Amazon products!</p>
        <script type="text/javascript">amzn_assoc_ad_type ="responsive_search_widget"; amzn_assoc_tracking_id ="wordfrequency-20"; amzn_assoc_marketplace ="amazon"; amzn_assoc_region ="CA"; amzn_assoc_placement =""; amzn_assoc_search_type = "search_widget";amzn_assoc_width ="auto"; amzn_assoc_height ="auto"; amzn_assoc_default_search_category =""; amzn_assoc_default_search_key ="";amzn_assoc_theme ="light"; amzn_assoc_bg_color ="FFFFFF"; </script><script src="//z-na.amazon-adsystem.com/widgets/q?ServiceVersion=20070822&Operation=GetScript&ID=OneJS&WS=1&Marketplace=CA"></script>
    </div>
    
    <script type="text/javascript">
        var inputText;
        var inputTextLower;
        var tableText = document.getElementById("table");;
        
        var options = {
              modules: {
                toolbar: false
              },
              theme: 'snow'
        };
        var quill = new Quill('#editor', options);
    
        function decider() {
            quill.formatText(0, quill.getLength(), {
                'background': false,
            });
            inputText = quill.getText();
            inputTextLower = inputText.toLowerCase();

            if (inputText != "\n") {
                tableText.innerHTML = ""
                tableText.innerHTML += "<tr><th>Word</th><th>Frequency</th></tr>"
                textCounter();
            } else {
                tableText.innerHTML = ""
                document.getElementById("resultsHeader").innerHTML = "";
            }
        }
        
        function textCounter() {
            var pattern = /\w+/g,
                string = inputTextLower;
                matchedWords = string.match( pattern );
            var counts = matchedWords.reduce(function ( stats, word ) {
                if ( stats.hasOwnProperty( word ) ) {
                    stats[ word ] = stats[ word ] + 1;
                } else {
                    stats[ word ] = 1;
                }
                return stats;
            }, {} );
            
            let sortedCounts = Object.entries(counts).sort((a, b) => b[1] - a[1]);
            
            for (const count of sortedCounts) {
                if (count[0] != "s" && count[0] != "ve") {
                    tableText.innerHTML += `<tr><td>${count[0]}</td><td>${count[1]}</td></tr>`;
                }
            }
            
            var resultsHeader = document.getElementById("resultsHeader");
            resultsHeader.textContent = "Results";
            document.getElementById("submitbutton").value = "Check again";
        }
        
        function getIndicesOf(word) {
            var wordRegex = new RegExp(word, "gi");
            var regex = wordRegex,result,indices=[];
            while((result=regex.exec(inputText)))
                {
                    indices.push(result.index);
                }
                return indices;
        }
        
        function highlightWord() {
            if (document.getElementById("wordToHighlight").value != "") {
                quill.formatText(0, quill.getLength(), {
                    'background': false
                });
                var wordToHighlight = document.getElementById("wordToHighlight").value;
                wordToHighlight = wordToHighlight.toLowerCase();
                inputText = quill.getText();
                var wordToHighlightWithRegexWordBoundary = `\\b${wordToHighlight}\\b`
                let re = new RegExp(wordToHighlightWithRegexWordBoundary, "gi");
                let match = re.test(inputText);
                if (match) {
                   let indices = getIndicesOf(re);
                   let length = wordToHighlight.length;
                   indices.forEach(index =>
                        quill.formatText(index, length, {
                       'background': 'rgb(144,238,144)'
                   }));
                }
            } else {
                quill.formatText(0, quill.getLength(), {
                    'background': false,
                });
            }
        }
    </script>
</body>
<footer>
    <p>Made by Rohan Taneja | Inspired by Sydney Shiffman</p>
</footer>
</html>
